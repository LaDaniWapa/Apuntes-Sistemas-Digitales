# Tema 11: Símplez. Modelo Procesal

## Introducción

Este es el tema donde "todo cobra vida". Si el Modelo Estructural (Tema 8 y 10) era el "mapa de carreteras" y el Modelo Funcional (Tema 9) era el "código de circulación", el **Modelo Procesal** es ver el tráfico en movimiento: describe la **dinámica interna** y cómo cambian los valores (0 y 1) en los cables a lo largo del tiempo.

## Concepto Clave: El Cronograma

Un **cronograma** es una gráfica que muestra el estado de las microórdenes (señales de control) y los buses en cada instante de reloj durante la ejecución de una instrucción.

## Diagrama de Estados (El ciclo de vida de una instrucción)

La CPU no ejecuta las instrucciones de golpe, sino que sigue una secuencia de estados o fases sincronizadas por el reloj. El secuenciador de Símplez se mueve por estos 4 estados principales:

- **Estado** **​`I0`​**​  **(Búsqueda):**  Se lee la instrucción de la memoria y se lleva al **Registro de Instrucción** (`RI`​). Se incrementa el **Contador de Programa** (`CP`).

  - *Paso común a todas las instruccions.*
- **Estado** **​`I1`​**​  **(Decodificación/Ejecución):**  Se analiza qué instrucción es:

  - Si **NO** necesita datos extra de memoria (`CLR`​, `DEC`​, `BR`​), se ejecuta aquí mismo y se vuelve a `I0`.
  - Si **SÍ** necesita datos de memoria (`ADD`​, `LD`​, `ST`​), se prepara la dirección del operador y se pasa al estado `O0`.
- **Estado** **​`O0`​**​  **(Operando):**  Se accede a la memoria para leer el dato o escribir el resultado.
- **Estado** **​`O1`​**​  **(Actualización):**  Se prepara la dirección de la siguiente instrucción y se vuelve a la `I0`

‍

![img_0319](assets/img_0319-20251228184745-l3cea1y.jpg)

## Cronograma del Ciclo `I0`

Todas las instrucciones empiezan igual. En el cliclo de reloj `I0`ocurren tres cosas simultáneas:

- **Lectura (**​**​`lec`​**​ **):**  Se activa para pedir el dato a la memoria.
- **Entrada** **​`R1`​**​  **(**​**​`eri`​**​ **):**  Se activa para que le dato que llega por el **Bus D** se guarde en el **Registro de Instrucción.**
- **Incrementar CP (**​**​`incp`​**​ **):**  Se suma 1 al contador para apuntar a la siguiente instrucción.

## **Ejecución de Instrucciones (Ejemplos)**

El tema detalla las microórdenes específicas para cada instrucción:

- **Instrucciones sin operando en memoria (Rápidas - 2 ciclos):**

  - **CLR**  **(Borrar):**  En la fase `I1`​, activa `pac`​ (puesta a cero de la ALU) y `eac` (cargar en acumulador).
  - **DEC**  **(Decrementar):**  En la fase `I1`​, activa `dec1`​ (restar 1 en ALU) y `eac`.
  - **BR**  **(Salto incondicional):**  En la fase `I1`​, carga la dirección de salto en el CP (`ecp`​) y actualiza el registro de direcciones (`era`) para saltar inmediatamente.
- **Instrucciones con operando en memoria (Lentas - 4 ciclos):**

  - **LD**  **(Cargar)**

    - ​**​`I1`​**​ **:**  Manda la dirección del dato del RI al Registro de Direcciones (`sri`​, `era`).
    - ​**​`O0`​**​ **:**  Lee de memoria (`lec`​) y guarda en el acumulador (`tra2`​, `eac`).
    - ​**​`O1`​**​ **:**  Prepara la siguiente instrucción (`scp`​, `era`).
  - **ST**  **(Guardar)**

    - ​**​`I1`​**​ **:**  Prepara la dirección (`sri`​, `era`​) y saca el dato del acumulador al bus (`sac`).
    - ​**​`O0`​**​ **:**  Escribe en memoria (`esc`​), manteniendo el dato en el bus (`sac`).
    - ​**​`O1`​**​ **:**  Prepara la siguiente instrucción (`scp`​, `era`).
  - **ADD**  **(Sumar)**

    - ​**​`I1`​**​ **:**  Manda la dirección del dato del RI al Registro de Direcciones (`sri`​, `era`).
    - ​**​`O0`​**​ **:**  Lee de memoria (`lec`​) y suma +1 en el acumulador (`sum`).
    - ​**​`O1`​**​ **:**  Prepara la siguiente instrucción (`scp`​, `era`).

## Casos Especiales

- **BZ (Salto condicional):**  Si el flag $Z=1$, se comporta como un salto (**​`BR`​**). SI $Z=0$, no hace nada, pero debe ejecutar microórdenes para actualizar el Registro de Direcciones (`scp`​, `era`) y poder leer la siguiente instrucción correctamente.
- **HALT:**  Entra en un bucle infinito sobre sí mismo en el estado **​`I1`​**​, impidiendo volver a **​`I0`​**.
